---
import '@/styles/global.css';
import '@/components/ui/ThemeToggle.css';
import ThemeToggle from '@/components/ui/ThemeToggle';

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Neil's City - A portfolio of work across AI, Architecture, DX, Infrastructure, and Open Source" } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Prevent flash of wrong theme -->
    <script is:inline>
      (function() {
        const stored = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = stored === 'dark' || stored === 'light' 
          ? stored 
          : (prefersDark ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
        document.documentElement.classList.add(theme);
      })();
    </script>
    
    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link 
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@500;600;700&display=swap" 
      rel="stylesheet" 
    />
    
    <title>{title} | Neil's City</title>
  </head>
  <body>
    <header class="site-header">
      <a href="/" class="site-logo">
        <span class="logo-icon">üèôÔ∏è</span>
        <span class="logo-text">Neil's City</span>
      </a>
      <nav class="site-nav">
        <ThemeToggle client:load />
      </nav>
    </header>
    
    <main>
      <slot />
    </main>
    
    <footer class="site-footer">
      <p>¬© {new Date().getFullYear()} Neil Kalman</p>
    </footer>
  </body>
</html>

<style is:global>
  /* Site Header */
  .site-header {
    position: sticky;
    top: 0;
    z-index: var(--z-sticky);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-3) var(--container-padding);
    background: var(--bg-default);
    border-bottom: 1px solid var(--border-subtle);
    backdrop-filter: blur(8px);
    background: color-mix(in srgb, var(--bg-default) 85%, transparent);
  }
  
  .site-logo {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    text-decoration: none;
    color: var(--text-primary);
    font-weight: var(--font-semibold);
    font-size: var(--text-lg);
  }
  
  .site-logo:hover {
    color: var(--brand-primary);
  }
  
  .logo-icon {
    font-size: var(--text-xl);
  }
  
  .site-nav {
    display: flex;
    align-items: center;
    gap: var(--space-4);
  }
  
  /* Site Footer */
  .site-footer {
    padding: var(--space-8) var(--container-padding);
    text-align: center;
    color: var(--text-muted);
    font-size: var(--text-sm);
    border-top: 1px solid var(--border-subtle);
    margin-top: auto;
  }
  
  /* Ensure body is full height for footer positioning */
  body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  
  main {
    flex: 1;
  }
</style>
